https://nvd.nist.gov/vuln/detail/cve-2023-2976
https://github.com/advisories/GHSA-7g45-4rm6-3mm3

default temporary directory
in `FileBackedOutputStream`
- other users can still access these files created by FileBackedOutputStream

fix
https://github.com/google/guava/releases/tag/v32.0.0

commit (with broken windows)
https://github.com/google/guava/commit/feb83a1c8fd2e7670b244d5afd23cba5aca43284

windows fix:
https://github.com/google/guava/commit/fdbf77d3f2b826fc0a70b1f9b9994b140ddf3bd8

Fix:
Restrict current file perms to app
- if not possible (Android Ice Cream Sandwich release)
- Throw exception

New class TempFIleCreator

`cpg.typeDecl.name("Files").method.name("createTempDir").call.code(".*mkdir.*")`
![[Pasted image 20250618132809.png]]

`cpg.typeDecl.where(_.fullName("com.google.common.io.Files")).method.name("createTempDir").call.where(_.code(".*\\.mkdir\\(\\)")).nonEmpty

When you get some free time could you go over the readme on the feature/engine branch, I gave a short outline of how the functions interact, also added some skeleton files.
Have a look and lmk if everything seems okay

`cpg.call.name("fromString").where(_.argument.code(".*rw-------.*|.*rwx------.*")).where(_.code(".*PosixFilePermissions.*")).where(_.file.name(".*TempFileCreator.*")).nonEmpty`


Version check 
Guava
FTY-20230614-73534.json
CVE-2023-2976

Reported: (both jre and android packages)
1.0 to 31.1 on Unix systems and Android Ice Cream Sandwich

Scans from Version 10.0 -> 33.4.8-jre && google-guava r03 -> google-guava r09
Affected: 10 -> 31.1-jre && google-guava r03 -> google-guava r09
Safe: 32.0.0 -> 33.4.8