Gathering evidence after an incident
## Searching files

file command to get file info 

grep
https://ryanstutorials.net/linuxtutorial/grep.php
https://fireship.io/lessons/regex-cheat-sheet-js/

find
https://www.plesk.com/blog/various/find-files-in-linux-via-command-line/

grep -rE "pico"  


## Disk analysis
Sleuthkit

Disk Image Layers
Filename → Inode → Blocks → Physical Media
mmls -> blkcat -> icat -> fls

- **Media**
	- Actual physical Medium
	- Stores raw magnetic/electrical signals 
	- Access Bit streams
	- sleuthkit prepend: mm
		- Use mmls
			- partition table 
			- info to access other layers
	
- **Block Layer**
	- Fixed sized chunks
	- Abstracts raw media
	- Smallest unit of IO
	-  sleuthkit prepend: blk
		- use blkcat
			- Outputs contents of a single block

- **Inode Layer** (metadata)
	- Meta data structure for each file (depends on file system e.g. ext4)
	- Stores
		- File Size
		- Owner
		- Permissions
		- time stamps 
		- block pointer (where data is on disk)
		- table of contents
	- sleuthkit prepend: i
		- use icat
			- output single file based on inode number
			- ***USE TO VIEW ACTUAL FILE CONTENT***

- **Filename Layer**
	- Human readable mapping of filename -> inode
	- Access files by name 
	- sleuthkit prepend: f
		- use fls
			- lists all files on an image starting from root

Usage
![[Pasted image 20250706143121.png]]
partition 002 contains our os 
start: 0000002048
end: 0000204799

Use start as offset to fls:
![[Pasted image 20250706143524.png]]

inode for home is 15617

Use innode number to view folder
empty folder return nothing
![[Pasted image 20250706144021.png]]

chal2
![[Pasted image 20250706144940.png]]


chal3
icat -o 0000411648 disk.flag.img 1782 | xxd
`00000000: 5361 6c74 6564 5f5f 53b3 2b25 89af b62b  Salted__S.+%...+`
`00000010: c50f 4f80 f26b 821e 13d1 9228 4185 bfcd  ..O..k.....(A...`
`00000020: e363 f5f4 0c40 5dd4 a31b a20a 4ca1 dea2  .c...@].....L...`
`00000030: c8a4 37f9 2014 b3cb f1d8 8e24 01c4 2725  ..7. ......$..'%`

![[Pasted image 20250706145742.png]]

aes256 decrypt
![[Pasted image 20250706150110.png]]

## Packet analysis 
Use Follow stream in wireshark

